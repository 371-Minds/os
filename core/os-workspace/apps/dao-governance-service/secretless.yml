# Secretless Broker Configuration for DAO Governance Service
# Zero-Trust Architecture: All credentials fetched from Universal Tool Server
version: "2"

services:
  # Service for our main database (TiDB/PostgreSQL)
  dao-governance-db:
    connector: "tcp"
    listenOn: "tcp://127.0.0.1:5432" # The local port our app will connect to
    credentials:
      # These paths tell the broker where to find the secrets in the UTS
      - name: "username"
        provider: "http"
        get: "http://uts.internal/secrets/dao-governance-db/username"
      - name: "password"
        provider: "http"
        get: "http://uts.internal/secrets/dao-governance-db/password"
      - name: "host"
        provider: "http"
        get: "http://uts.internal/secrets/dao-governance-db/host"
      - name: "port"
        provider: "http"
        get: "http://uts.internal/secrets/dao-governance-db/port"

  # Service for the Novu notification API
  novu-api:
    connector: "http"
    listenOn: "tcp://127.0.0.1:8081" # Local proxy for Novu
    credentials:
      - name: "api_key"
        provider: "http"
        get: "http://uts.internal/secrets/novu/api-key"
      - name: "api_url"
        provider: "http"
        get: "http://uts.internal/secrets/novu/api-url"

  # Service for blockchain connectivity (if needed)
  blockchain-rpc:
    connector: "http"
    listenOn: "tcp://127.0.0.1:8545" # Local proxy for blockchain RPC
    credentials:
      - name: "rpc_url"
        provider: "http"
        get: "http://uts.internal/secrets/blockchain/rpc-url"
      - name: "api_key"
        provider: "http"
        get: "http://uts.internal/secrets/blockchain/api-key"
